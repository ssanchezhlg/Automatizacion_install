---
- name: Obtener la información del archivo sources.list
  stat:
    path: /etc/apt/sources.list
  register: sources_list_status

- name: Obtener la información del archivo de plantilla
  stat:
    path: plantillas/sources-debian-12.list.j2
  register: template_status

- name: Reemplazar sources.list con uno personalizado si el contenido es diferente
  blockinfile:
    path: /etc/apt/sources.list
    backup: yes
    block: "{{ lookup('file', 'plantillas/sources-debian-12.list.j2') | trim }}"
  when: sources_list_status.stat.exists and template_status.stat.exists and (lookup('file', 'plantillas/sources-debian-12.list.j2') | trim) != (lookup('file', '/etc/apt/sources.list') | trim)
